{% extends 'base.html' %}

{% block content %}
  <h2>Applying for position: {{ job.title }}</h2>
  <h3>Company: {{ job.company }}</h3>

  <form id="jobApplicationForm" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {% for field in form.visible_fields %}
      {% if form.non_field_errors %}
        <div class="alert alert-danger">
          {% for error in form.non_field_errors %}
            {{ error }}
          {% endfor %}
        </div>
      {% endif %}
      <div class="form-group">
        {{ field.label_tag }}
        {% if field.name == 'resume_file' %}
          {% if form.resume_file.value %}
            <p>Uploaded Resume: {{ form.resume_file.value }}</p>
          {% endif %}
          {{ form.resume_file }}
        {% else %}
          {{ field }}
        {% endif %}
      </div>
    {% endfor %}
    <button type="submit" class="btn btn-primary">Apply</button>
  </form>

  <script>
  // Choose resume button click event handler
  document.getElementById('chooseResumeBtnText').addEventListener('click', function() {
    document.getElementById('chooseResumeBtn').click();
  });

  // Resume file field change event handler
  document.getElementById('chooseResumeBtn').addEventListener('change', function() {
    var selectedResumeFile = document.getElementById('chooseResumeBtn').files[0];
    document.getElementById('id_resume_file').value = selectedResumeFile.name;
  });
  </script>
{% endblock %}
